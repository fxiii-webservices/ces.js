var CES=function(){var t=function(n,e){var i=t.resolve(n,e||"/"),o=t.modules[i];if(!o)throw new Error("Failed to resolve module "+n+", tried "+i);var s=t.cache[i],r=s?s.exports:o();return r};return t.paths=[],t.modules={},t.cache={},t.extensions=[".js",".coffee",".json"],t._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},t.resolve=function(){return function(n,e){function i(n){if(n=a.normalize(n),t.modules[n])return n;for(var e=0;e<t.extensions.length;e++){var i=t.extensions[e];if(t.modules[n+i])return n+i}}function o(n){n=n.replace(/\/+$/,"");var e=a.normalize(n+"/package.json");if(t.modules[e]){var o=t.modules[e](),s=o.browserify;if("object"==typeof s&&s.main){var r=i(a.resolve(n,s.main));if(r)return r}else if("string"==typeof s){var r=i(a.resolve(n,s));if(r)return r}else if(o.main){var r=i(a.resolve(n,o.main));if(r)return r}}return i(n+"/index")}function s(t,n){for(var e=r(n),s=0;s<e.length;s++){var a=e[s],u=i(a+"/"+t);if(u)return u;var c=o(a+"/"+t);if(c)return c}var u=i(t);return u?u:void 0}function r(t){var n;n="/"===t?[""]:a.normalize(t).split("/");for(var e=[],i=n.length-1;i>=0;i--)if("node_modules"!==n[i]){var o=n.slice(0,i+1).join("/")+"/node_modules";e.push(o)}return e}if(e||(e="/"),t._core[n])return n;var a=t.modules.path();e=a.resolve("/",e);var u=e||"/";if(n.match(/^(?:\.\.?\/|\/)/)){var c=i(a.resolve(u,n))||o(a.resolve(u,n));if(c)return c}var l=s(n,u);if(l)return l;throw new Error("Cannot find module '"+n+"'")}}(),t.alias=function(n,e){var i=t.modules.path(),o=null;try{o=t.resolve(n+"/package.json","/")}catch(s){o=t.resolve(n,"/")}for(var r=i.dirname(o),a=(Object.keys||function(t){var n=[];for(var e in t)n.push(e);return n})(t.modules),u=0;u<a.length;u++){var c=a[u];if(c.slice(0,r.length+1)===r+"/"){var l=c.slice(r.length);t.modules[e+l]=t.modules[r+l]}else c===r&&(t.modules[e]=t.modules[r])}},function(){var n={},e="undefined"!=typeof window?window:{},i=!1;t.define=function(o,s){!i&&t.modules.__browserify_process&&(n=t.modules.__browserify_process(),i=!0);var r=t._core[o]?"":t.modules.path().dirname(o),a=function(n){var e=t(n,r),i=t.cache[t.resolve(n,r)];return i&&null===i.parent&&(i.parent=u),e};a.resolve=function(n){return t.resolve(n,r)},a.modules=t.modules,a.define=t.define,a.cache=t.cache;var u={id:o,filename:o,exports:{},loaded:!1,parent:null};t.modules[o]=function(){return t.cache[o]=u,s.call(u.exports,a,u,u.exports,r,o,n,e),u.loaded=!0,u.exports}}}(),t.define("path",function(t,n,e,i,o,s){function r(t,n){for(var e=[],i=0;i<t.length;i++)n(t[i],i,t)&&e.push(t[i]);return e}function a(t,n){for(var e=0,i=t.length;i>=0;i--){var o=t[i];"."==o?t.splice(i,1):".."===o?(t.splice(i,1),e++):e&&(t.splice(i,1),e--)}if(n)for(;e--;e)t.unshift("..");return t}var u=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;e.resolve=function(){for(var t="",n=!1,e=arguments.length;e>=-1&&!n;e--){var i=e>=0?arguments[e]:s.cwd();"string"==typeof i&&i&&(t=i+"/"+t,n="/"===i.charAt(0))}return t=a(r(t.split("/"),function(t){return!!t}),!n).join("/"),(n?"/":"")+t||"."},e.normalize=function(t){var n="/"===t.charAt(0),e="/"===t.slice(-1);return t=a(r(t.split("/"),function(t){return!!t}),!n).join("/"),t||n||(t="."),t&&e&&(t+="/"),(n?"/":"")+t},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,function(t){return t&&"string"==typeof t}).join("/"))},e.dirname=function(t){var n=u.exec(t)[1]||"",e=!1;return n?1===n.length||e&&n.length<=3&&":"===n.charAt(1)?n:n.substring(0,n.length-1):"."},e.basename=function(t,n){var e=u.exec(t)[2]||"";return n&&e.substr(-1*n.length)===n&&(e=e.substr(0,e.length-n.length)),e},e.extname=function(t){return u.exec(t)[3]||""},e.relative=function(t,n){function i(t){for(var n=0;n<t.length&&""===t[n];n++);for(var e=t.length-1;e>=0&&""===t[e];e--);return n>e?[]:t.slice(n,e-n+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var o=i(t.split("/")),s=i(n.split("/")),r=Math.min(o.length,s.length),a=r,u=0;r>u;u++)if(o[u]!==s[u]){a=u;break}for(var c=[],u=a;u<o.length;u++)c.push("..");return c=c.concat(s.slice(a)),c.join("/")}}),t.define("__browserify_process",function(t,n,e,i,o,s){var s=n.exports={};s.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(n){var e=[];return window.addEventListener("message",function(t){if(t.source===window&&"browserify-tick"===t.data&&(t.stopPropagation(),e.length>0)){var n=e.shift();n()}},!0),function(t){e.push(t),window.postMessage("browserify-tick","*")}}return function(t){setTimeout(t,0)}}(),s.title="browser",s.browser=!0,s.env={},s.argv=[],s.binding=function(n){if("evals"===n)return t("vm");throw new Error("No such module. (Possibly not yet loaded)")},function(){var n,e="/";s.cwd=function(){return e},s.chdir=function(i){n||(n=t("path")),e=n.resolve(i,e)}}()}),t.define("/src/class.js",function(t,n){var e=!1,i=/xyz/.test(function(){})?/\b_super\b/:/.*/,o=n.exports=function(){};o.extend=function(t){function n(){!e&&this.init&&this.init.apply(this,arguments)}var o=this.prototype;e=!0;var s=new this;e=!1;for(var r in t)s[r]="function"==typeof t[r]&&"function"==typeof o[r]&&i.test(t[r])?function(t,n){return function(){var e=this._super;this._super=o[t];var i=n.apply(this,arguments);return this._super=e,i}}(r,t[r]):t[r];return n.prototype=s,n.prototype.constructor=n,n.extend=arguments.callee,n}}),t.define("/src/component.js",function(t,n){{var e=t("./class");n.exports=e.extend({name:""})}}),t.define("/src/entity.js",function(t,n){var e=t("./class"),i=t("./signal"),o=n.exports=e.extend({init:function(){this.id=o._id++,this._components={},this.onComponentAdded=new i,this.onComponentRemoved=new i},hasComponent:function(t){return void 0!==this._components["$"+t]},getComponent:function(t){return this._components["$"+t]},addComponent:function(t){this._components["$"+t.name]=t,this.onComponentAdded.emit(this,t.name)},removeComponent:function(t){this._components["$"+t]=void 0,this.onComponentRemoved.emit(this,t)}});o._id=0}),t.define("/src/signal.js",function(t,n){{var e=t("./class");n.exports=e.extend({init:function(){this._listeners=[]},add:function(t){this._listeners.push(t)},remove:function(t){var n,e,i=this._listeners;for(n=0,e=i.length;e>n;++n)if(i[n]===t)return i.splice(n,1),!0;return!1},emit:function(){var t,n,e=arguments,i=this._listeners;for(t=0,n=i.length;n>t;++t)i[t].apply(null,e)}})}}),t.define("/src/system.js",function(t,n){{var e=t("./class");n.exports=e.extend({init:function(){this.world=null},update:function(){throw new Error("Subclassed should override this method")}})}}),t.define("/src/world.js",function(t,n){{var e=t("./class"),i=t("./family"),o=t("./entitylist");n.exports=e.extend({init:function(){this._families={},this._systems=[],this._entities=new o},addSystem:function(t){var n,e,i;return t.world=this,this._systems.push(t),this._systemHasValidComponentDeclaration(t)&&(n=this.getEntities.apply(this,t.components)),this._systemHasValidComponentDeclaration(t)&&void 0!==t.setupEntity&&(n.map(function(n){t.setupEntity(n)}),i=this._families,e="$"+t.components.join(","),i[e].onEntityAdded.add(function(n){t.setupEntity(n)})),this._systemHasValidComponentDeclaration(t)&&void 0!==t.teardownEntity&&(i=this._families,e="$"+t.components.join(","),i[e].onEntityRemoved.add(function(n){t.teardownEntity(n)})),this},removeSystem:function(t){var n,e,i;for(n=this._systems,e=0,i=n.length;i>e;++e)n[e]===t&&n.splice(e,1)},addEntity:function(t){var n,e,i;n=this._families;for(e in n)n[e].addEntityIfMatch(t);i=this,t.onComponentAdded.add(function(t,n){i._onComponentAdded(t,n)}),t.onComponentRemoved.add(function(t,n){i._onComponentRemoved(t,n)}),this._entities.add(t)},removeEntity:function(t){var n,e;n=this._families;for(e in n)n[e].removeEntity(t);this._entities.remove(t)},getEntities:function(){var t,n,e;if(t="$"+Array.prototype.join.call(arguments,","),n=this._families,!n[t])for(n[t]=new i(Array.prototype.slice.call(arguments)),e=this._entities.head;e;e=e.next)n[t].addEntityIfMatch(e.entity);return n[t].getEntities()},update:function(t){var n,e,i,o;for(n=this._systems,e=0,i=n.length;i>e;++e)o=n[e],this._systemHasValidComponentDeclaration(o)&&(o.entities=this.getEntities.apply(this,o.components)),o.update(t)},_onComponentAdded:function(t,n){var e,i;e=this._families;for(i in e)e[i].onComponentAdded(t,n)},_onComponentRemoved:function(t,n){var e,i;e=this._families;for(i in e)e[i].onComponentRemoved(t,n)},_systemHasValidComponentDeclaration:function(t){return!!t.components&&t.components.length>0}})}}),t.define("/src/family.js",function(t,n){{var e=t("./class"),i=t("./entitylist"),o=t("./signal");n.exports=e.extend({init:function(t){this._componentNames=t,this._entities=new i,this.onEntityAdded=new o,this.onEntityRemoved=new o},getEntities:function(){return this._entities.toArray()},addEntityIfMatch:function(t){!this._entities.has(t)&&this._matchEntity(t)&&(this._entities.add(t),this.onEntityAdded.emit(t,this._componentNames))},removeEntity:function(t){var n=this._entities.remove(t);n&&this.onEntityRemoved.emit(t,this._componentNames)},onComponentAdded:function(t){this.addEntityIfMatch(t)},onComponentRemoved:function(t,n){var e,i,o;if(this._entities.has(t))for(e=this._componentNames,i=0,o=e.length;o>i;++i)e[i]===n&&(this._entities.remove(t),this.onEntityRemoved.emit(t,this._componentNames))},_matchEntity:function(t){var n,e,i;for(n=this._componentNames,e=0,i=n.length;i>e;++e)if(!t.hasComponent(n[e]))return!1;return!0}})}}),t.define("/src/entitylist.js",function(t,n){{var e=t("./class"),i=e.extend({init:function(t){this.entity=t,this.prev=null,this.next=null}});n.exports=e.extend({init:function(){this.head=null,this.tail=null,this.length=0,this._entities={}},add:function(t){var n=new i(t);null===this.head?this.head=this.tail=n:(n.prev=this.tail,this.tail.next=n,this.tail=n),this.length+=1,this._entities[t.id]=n},remove:function(t){var n=this._entities[t.id];return void 0===n?!1:(null===n.prev?this.head=n.next:n.prev.next=n.next,null===n.next?this.tail=n.prev:n.next.prev=n.prev,this.length-=1,delete this._entities[t.id],!0)},has:function(t){return void 0!==this._entities[t.id]},clear:function(){this.head=this.tail=null,this.length=0,this._entities={}},toArray:function(){var t,n;for(t=[],n=this.head;n;n=n.next)t.push(n.entity);return t}})}}),t.define("/index.js",function(t,n){n.exports={Class:t("./src/class"),Component:t("./src/component"),Entity:t("./src/entity"),System:t("./src/system"),World:t("./src/world")}}),t("/index.js"),t("/index.js")}();